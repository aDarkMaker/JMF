# JMcomic Fetcher 打包版本使用说明

## 解决的主要问题

这个更新版本解决了以下打包后运行的问题：

### 1. 路径问题

- **问题**: 打包后的应用无法正确定位配置文件和输出目录
- **解决方案**:
  - 配置文件和设置现在保存在用户数据目录 (`%APPDATA%\JMF\settings\`)
  - 默认PDF输出目录设置为用户文档目录 (`用户\文档\JMF\PDF\`)
  - 支持用户自定义输出目录

### 2. 设置无法更改问题

- **问题**: 在打包后的应用中，设置文件保存在只读的程序安装目录
- **解决方案**:
  - 设置文件现在保存在用户可写的数据目录
  - 配置文件会自动从资源目录复制到用户数据目录
  - 所有设置更改都会正确保存和读取

### 3. 文件夹无法打开问题

- **问题**: "打开下载目录"功能指向不正确的路径
- **解决方案**:
  - 输出目录现在使用绝对路径
  - 自动创建必要的目录结构
  - 确保目录权限正确

## 新的目录结构

### 开发环境

```
JMF/
├── core/           # Python脚本和配置
├── PDF/            # 默认输出目录
├── settings.json   # 应用设置
└── ...
```

### 打包后的应用

```
用户数据目录/
├── %APPDATA%/JMF/settings/
│   ├── option.yml      # Python库配置
│   └── settings.json   # 应用设置
└── %USERPROFILE%/Documents/JMF/PDF/  # 默认PDF输出目录
```

## 首次运行

1. **自动初始化**: 应用首次运行时会自动：
   - 创建必要的用户目录
   - 生成默认配置文件
   - 设置合适的默认路径

2. **配置检查**: 如果检测到旧的配置文件，会自动迁移到新位置

## 使用建议

1. **自定义输出目录**:
   - 通过设置 → 常规 → 输出目录来更改默认路径
   - 建议使用用户可写的目录（如文档、桌面等）

2. **权限问题**:
   - 如果遇到权限问题，请以管理员身份运行一次
   - 或者将输出目录设置为用户文档目录

3. **故障排除**:
   - 如果设置无法保存，检查用户数据目录的写入权限
   - 如果PDF文件夹无法打开，检查输出目录路径是否有效

## 技术细节

- **用户数据目录**: `app.getPath('userData')`
- **文档目录**: `app.getPath('documents')`
- **配置文件路径**: 优先使用用户数据目录中的配置
- **Python脚本**: 支持命令行参数 `--config` 和 `--output`

## 兼容性

- 兼容现有的配置格式
- 自动处理旧版本的设置迁移
- 保持与开发环境的功能一致性
